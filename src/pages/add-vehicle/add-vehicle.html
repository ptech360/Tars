<ion-header>
    <ion-navbar color="primary">
        <ion-title>Add Involved Vehicle</ion-title>
    </ion-navbar>
</ion-header>

<!-- <ion-title>Vehicle 1</ion-title> -->

<ion-content class="background" padding>
    <form [formGroup]="vehicleFormGroup">
        <!-- <ng-container formArrayName="vehicles"> -->
            <!-- <ion-card *ngFor="let vehicle of accidentForm.controls.vehicles['controls']; let i = index"
                [formGroupName]="i"> -->
                <ion-card>
                <ion-card-header no-padding>
                    <ion-item>
                        Vehicle {{index+1}}
                    </ion-item>
                </ion-card-header>
                <ion-item>
                    <ion-label stacked>Vehicle Number*</ion-label>
                    <ion-input type="text" formControlName="number" autocapitalize="characters"></ion-input>
                </ion-item>
                <ion-item>
                    <ion-label stacked>Vehicle Model*</ion-label>
                    <ion-input type="text" formControlName="model" autocapitalize="characters"></ion-input>
                </ion-item>
                <div padding>
                    <ion-card *ngFor="let img of vehicleImageUrls;let i = index;">
                        <img [src]="img.value.url" />
                        <ion-row>
                            <ion-col text-right>
                                <button ion-button color="danger" clear icon-only item-end
                                    (click)="delVehicleImage(vehicleFormGroup,i)">
                                    <ion-icon name='trash' is-active="false"></ion-icon>
                                </button>
                            </ion-col>
                        </ion-row>
                    </ion-card>
                </div>
                <div text-center>
                    <h2 color="primary">Capture Photos/Video</h2>
                    <button ion-button icon-only class="center" margin-bottom
                        (click)="captureVehicle(vehicleFormGroup)">
                        <ion-icon name="camera"></ion-icon>
                    </button>
                </div>

                <!-- <ion-list *ngIf="vehicle.get('persons')"> -->
                    <ion-list>
                    <div formArrayName="persons">
                        <ion-card [formGroupName]="i"
                            *ngFor="let person of vehicleFormGroup.controls.persons['controls'];let i=index;">
                <!-- <ion-list>
                    <div formArrayName="persons">
                        <ion-card [formGroupName]="i"
                            *ngFor="let person of vehicle.controls.persons['controls'];let i=index;"> -->
                            <!-- <ion-list-header margin-top-bottom-0 *ngIf="i==0">
                                Driver Details
                            </ion-list-header>
                            <ion-list-header margin-top-bottom-0 *ngIf="i>0">
                                Passenger Details
                            </ion-list-header> -->
                            <ion-card-header no-padding>
                                <ion-item>
                                    <span *ngIf="i==0">Driver Details</span>
                                    <!-- Person {{i+1}} -->
                                    <span *ngIf="i>0">Passenger {{i}} Details</span>
                                    
                                    <button ion-button color="danger" clear icon-only item-end
                                        (click)="removePerson(i)">
                                        <ion-icon name='trash' is-active="false"></ion-icon>
                                    </button>
                                </ion-item>
                            </ion-card-header>
                            <ion-item>
                                <ion-label stacked>Name*</ion-label>
                                <ion-input type="text" formControlName="name"></ion-input>
                            </ion-item>
                            <ion-item>
                                <ion-label stacked>Driving Licence</ion-label>
                                <ion-input type="text" formControlName="licence" autocapitalize="characters">
                                </ion-input>
                            </ion-item>
                            <ion-item>
                                <ion-label stacked>Age*</ion-label>
                                <ion-input type="number" formControlName="age"></ion-input>
                            </ion-item>
                            <ion-item>
                                <ion-label stacked>Address*</ion-label>
                                <ion-textarea formControlName="address"></ion-textarea>
                            </ion-item>
                            <ion-item>
                                <ion-label>Gender*</ion-label>
                                <ion-select formControlName="gender">
                                    <ion-option value="Male">Male</ion-option>
                                    <ion-option value="Female">Female</ion-option>
                                </ion-select>
                            </ion-item>
                            <ion-item>
                                <ion-label>Under Influence*</ion-label>
                                <ion-toggle formControlName="underInfluence"></ion-toggle>
                            </ion-item>
                            <ion-item>
                                <ion-label stacked>Type and Extent of Human Factor</ion-label>
                                <ion-input formControlName="typeAndExtendOfHumanFactor"></ion-input>
                            </ion-item>
                            <ion-item>
                                <ion-label stacked>Nature of any injuries</ion-label>
                                <ion-input formControlName="natureOfAnyInjuries"></ion-input>
                            </ion-item>
                            <ion-item>
                                <ion-label stacked>Data on Socio-economic status</ion-label>
                                <ion-input formControlName="dataOnSocioEconomicStatus"></ion-input>
                            </ion-item>
                        </ion-card>
                    </div>

                </ion-list>
                <div padding-left padding-right >
                    <button ion-button block small *ngIf="vehicleFormGroup.controls.persons['controls'].length == 0" (click)="addDriver()">Add Driver</button>
                </div>
                <div padding-left padding-right>
                    <button ion-button block small *ngIf="vehicleFormGroup.controls.persons['controls'].length" (click)="addPerson()">Add Passenger</button>
                </div>
            </ion-card>
        <!-- </ng-container> -->
    </form>
    <div padding >
        <button type="button" ion-button block *ngIf="accidentForm['index']>accidentForm['numOfVehicle']-1" (click)="saveVehicle()">Save Vehicle</button>
    </div>

    <ng-container *ngIf="accidentForm['pedestrians']">
        <ion-card *ngFor="let ped of accidentForm['pedestrians']; let j=index">
            <ion-card-header>
                Pedestrain {{j+1}}
                <button ion-button color="danger" clear icon-only item-end
                (click)="removePedestrian(j)">
                <ion-icon name='trash' is-active="false"></ion-icon>
            </button>
            </ion-card-header>
            <ion-item>
                <ion-label>Name : {{ped.name}}</ion-label>
            </ion-item>
            <ion-item>
                <ion-label>Age : {{ped.age}}</ion-label>
            </ion-item>
            <ion-item>
                <ion-label>Gender : {{ped.gender}}</ion-label>
            </ion-item>
            <ion-item>
                <ion-label>Under Influence : {{ped.underInfluence}}</ion-label>
            </ion-item>
            <ion-item>
                <ion-label>Nature Of Any Injuries : {{ped.natureOfAnyInjuries}}</ion-label>
            </ion-item>
            <ion-item>
                <ion-label>Data On Socio Economic Status : {{ped.dataOnSocioEconomicStatus}}</ion-label>
            </ion-item>
            <ion-item>
                <ion-label>Type and Extend of Human Factor : {{ped.typeAndExtendOfHumanFactor}}</ion-label>
            </ion-item>
        </ion-card>
    </ng-container>

    <div padding>
        <button type="button" ion-button block color="tertiary" *ngIf="accidentForm['index']>accidentForm['numOfVehicle']-1" (click)="addPedestrian()">Add Pedestrain</button>
    </div>

</ion-content>
<ion-footer>
    <button type="button" ion-button block small>Back</button>
    <button type="button" ion-button block color="secondary" *ngIf="accidentForm['index']>accidentForm['numOfVehicle']-1" (click)="submitAccident()">Submit</button>
</ion-footer>